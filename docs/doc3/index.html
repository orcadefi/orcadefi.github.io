<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-alpha.64">
<title data-react-helmet="true">Orca Governance Token | Orca DeFi</title><meta data-react-helmet="true" name="docsearch:version" content="current,latest"><meta data-react-helmet="true" property="og:image" content="https://orcadefi.github.io//img/orcalogo.png"><meta data-react-helmet="true" property="twitter:image" content="https://orcadefi.github.io//img/orcalogo.png"><meta data-react-helmet="true" name="twitter:image:alt" content="Image for Orca DeFi"><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:title" content="Orca Governance Token | Orca DeFi"><meta data-react-helmet="true" name="description" content="Orca DAO tokens."><meta data-react-helmet="true" property="og:description" content="Orca DAO tokens."><meta data-react-helmet="true" property="og:url" content="https://orcadefi.github.io//docs/doc3"><link data-react-helmet="true" rel="shortcut icon" href="/img/faviconorca.ico"><link data-react-helmet="true" rel="canonical" href="https://orcadefi.github.io//docs/doc3"><link rel="stylesheet" href="/styles.606b8ca4.css">
<link rel="preload" href="/styles.40491fba.js" as="script">
<link rel="preload" href="/runtime~main.03d5b84e.js" as="script">
<link rel="preload" href="/main.760b6be9.js" as="script">
<link rel="preload" href="/1.6bcf3012.js" as="script">
<link rel="preload" href="/2.ef7fac2f.js" as="script">
<link rel="preload" href="/31.a2f0dcc7.js" as="script">
<link rel="preload" href="/32.2d58906c.js" as="script">
<link rel="preload" href="/f976f453.838baf88.js" as="script">
<link rel="preload" href="/17896441.bc9cefac.js" as="script">
<link rel="preload" href="/991b72a1.4bb81925.js" as="script">
</head>
<body>
<script>!function(){function e(e){document.documentElement.setAttribute("data-theme",e)}var t=function(){var e=null;try{e=localStorage.getItem("theme")}catch(e){}return e}();null!==t?e(t):window.matchMedia("(prefers-color-scheme: dark)").matches?e("dark"):window.matchMedia("(prefers-color-scheme: light)").matches?e("light"):e("dark")}()</script><div id="__docusaurus">
<nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a class="navbar__brand" href="/"><img class="navbar__logo" src="/img/orcalogo.png" alt="Orca DeFi"><strong class="navbar__title">Orca DeFi</strong></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/">Docs</a><a class="navbar__item navbar__link" href="/blog">Blog</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/orcadefi" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link" aria-label="GitHub repository"></a><div class="react-toggle react-toggle--disabled displayOnlyInLargeViewport_2aTZ"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_BsTx" style="margin-left:2px"> </span></div><div class="react-toggle-track-x"><span class="toggle_BsTx" style="margin-left:1px"> </span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" disabled="" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/"><img class="navbar__logo" src="/img/orcalogo.png" alt="Orca DeFi"><strong class="navbar__title">Orca DeFi</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a aria-current="page" class="menu__link navbar__link--active" href="/docs/">Docs</a></li><li class="menu__list-item"><a class="menu__link" href="/blog">Blog</a></li><li class="menu__list-item"><a href="https://github.com/orcadefi" target="_blank" rel="noopener noreferrer" class="menu__link header-github-link" aria-label="GitHub repository"></a></li></ul></div></div></div></nav><div class="main-wrapper"><div class="docPage_2gpo"><div class="docSidebarContainer_3_JD" role="complementary"><div class="sidebar_2urC"><div class="menu menu--responsive menu_5FrY"><button aria-label="Open Menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_Dm3K" xmlns="http://www.w3.org/2000/svg" height="24" width="24" viewBox="0 0 32 32" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Orca</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/">Welcome to Orca</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/doc0">Learn Orca</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">API</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/doc4">Orcadefi-API</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Repositories</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/doc1">Orcadefi-SDK</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/doc2">APR Rate Guide</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/doc5">Uniswap-Pairs-Prices</a></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">Library</a><ul class="menu__list"><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/docs/doc3">Orca Governance Token</a></li></ul></li></ul></div></div></div><main class="docMainContainer_3EyW"><div class="container padding-vert--lg docItemWrapper_1EkI"><div class="row"><div class="col docItemCol_2ASc"><div class="docItemContainer_3QWW"><article><header><h1 class="docTitle_1Lrw">Orca Governance Token</h1></header><div class="markdown"><p>Orca DAO tokens.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="orca-token"></a>Orca Token<a aria-hidden="true" tabindex="-1" class="hash-link" href="#orca-token" title="Direct link to heading">#</a></h3><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-pragma codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">interface IERC20 {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    function totalSupply() external view returns (uint);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    function balanceOf(address account) external view returns (uint);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    function transfer(address recipient, uint amount) external returns (bool);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    function allowance(address owner, address spender) external view returns (uint);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    function approve(address spender, uint amount) external returns (bool);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    function transferFrom(address sender, address recipient, uint amount) external returns (bool);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    event Transfer(address indexed from, address indexed to, uint value);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    event Approval(address indexed owner, address indexed spender, uint value);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">contract Context {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    constructor () internal { }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    // solhint-disable-previous-line no-empty-blocks</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    function _msgSender() internal view returns (address payable) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        return msg.sender;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">contract ERC20 is Context, IERC20 {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    using SafeMath for uint;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    mapping (address =&gt; uint) private _balances;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    mapping (address =&gt; mapping (address =&gt; uint)) private _allowances;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    uint private _totalSupply;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    function totalSupply() public view returns (uint) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        return _totalSupply;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    function balanceOf(address account) public view returns (uint) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        return _balances[account];</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    function transfer(address recipient, uint amount) public returns (bool) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        _transfer(_msgSender(), recipient, amount);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        return true;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    function allowance(address owner, address spender) public view returns (uint) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        return _allowances[owner][spender];</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    function approve(address spender, uint amount) public returns (bool) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        _approve(_msgSender(), spender, amount);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        return true;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    function transferFrom(address sender, address recipient, uint amount) public returns (bool) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        _transfer(sender, recipient, amount);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        _approve(sender, _msgSender(), _allowances[sender][_msgSender()].sub(amount, &quot;ERC20: transfer amount exceeds allowance&quot;));</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        return true;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    function increaseAllowance(address spender, uint addedValue) public returns (bool) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        _approve(_msgSender(), spender, _allowances[_msgSender()][spender].add(addedValue));</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        return true;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    function decreaseAllowance(address spender, uint subtractedValue) public returns (bool) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        _approve(_msgSender(), spender, _allowances[_msgSender()][spender].sub(subtractedValue, &quot;ERC20: decreased allowance below zero&quot;));</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        return true;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    function _transfer(address sender, address recipient, uint amount) internal {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        require(sender != address(0), &quot;ERC20: transfer from the zero address&quot;);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        require(recipient != address(0), &quot;ERC20: transfer to the zero address&quot;);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        _balances[sender] = _balances[sender].sub(amount, &quot;ERC20: transfer amount exceeds balance&quot;);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        _balances[recipient] = _balances[recipient].add(amount);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        emit Transfer(sender, recipient, amount);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    function _mint(address account, uint amount) internal {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        require(account != address(0), &quot;ERC20: mint to the zero address&quot;);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        _totalSupply = _totalSupply.add(amount);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        _balances[account] = _balances[account].add(amount);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        emit Transfer(address(0), account, amount);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    function _burn(address account, uint amount) internal {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        require(account != address(0), &quot;ERC20: burn from the zero address&quot;);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        _balances[account] = _balances[account].sub(amount, &quot;ERC20: burn amount exceeds balance&quot;);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        _totalSupply = _totalSupply.sub(amount);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        emit Transfer(account, address(0), amount);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    function _approve(address owner, address spender, uint amount) internal {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        require(owner != address(0), &quot;ERC20: approve from the zero address&quot;);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        require(spender != address(0), &quot;ERC20: approve to the zero address&quot;);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        _allowances[owner][spender] = amount;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        emit Approval(owner, spender, amount);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">contract ERC20Detailed is IERC20 {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    string private _name;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    string private _symbol;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    uint8 private _decimals;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    constructor (string memory name, string memory symbol, uint8 decimals) public {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        _name = name;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        _symbol = symbol;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        _decimals = decimals;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    function name() public view returns (string memory) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        return _name;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    function symbol() public view returns (string memory) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        return _symbol;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    function decimals() public view returns (uint8) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        return _decimals;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">library SafeMath {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    function add(uint a, uint b) internal pure returns (uint) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        uint c = a + b;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        require(c &gt;= a, &quot;SafeMath: addition overflow&quot;);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        return c;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    function sub(uint a, uint b) internal pure returns (uint) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        return sub(a, b, &quot;SafeMath: subtraction overflow&quot;);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    function sub(uint a, uint b, string memory errorMessage) internal pure returns (uint) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        require(b &lt;= a, errorMessage);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        uint c = a - b;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        return c;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    function mul(uint a, uint b) internal pure returns (uint) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        if (a == 0) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            return 0;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        uint c = a * b;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        require(c / a == b, &quot;SafeMath: multiplication overflow&quot;);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        return c;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    function div(uint a, uint b) internal pure returns (uint) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        return div(a, b, &quot;SafeMath: division by zero&quot;);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    function div(uint a, uint b, string memory errorMessage) internal pure returns (uint) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        // Solidity only automatically asserts when dividing by 0</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        require(b &gt; 0, errorMessage);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        uint c = a / b;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        return c;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">library Address {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    /**</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">     * @dev Returns true if `account` is a contract.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">     *</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">     * This test is non-exhaustive, and there may be false-negatives: during the</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">     * execution of a contract&#x27;s constructor, its address will be reported as</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">     * not containing a contract.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">     *</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">     * &gt; It is unsafe to assume that an address for which this function returns</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">     * false is an externally-owned account (EOA) and not a contract.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">     */</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    function isContract(address account) internal view returns (bool) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        // This method relies in extcodesize, which returns 0 for contracts in</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        // construction, since the code is only stored at the end of the</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        // constructor execution.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        // According to EIP-1052, 0x0 is the value returned for not-yet created accounts</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        // and 0xc5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470 is returned</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        // for accounts without code, i.e. `keccak256(&#x27;&#x27;)`</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        bytes32 codehash;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        bytes32 accountHash = 0xc5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        // solhint-disable-next-line no-inline-assembly</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        assembly { codehash := extcodehash(account) }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        return (codehash != 0x0 &amp;&amp; codehash != accountHash);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">library SafeERC20 {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    using SafeMath for uint;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    using Address for address;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    function safeTransfer(IERC20 token, address to, uint value) internal {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        callOptionalReturn(token, abi.encodeWithSelector(token.transfer.selector, to, value));</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    function safeTransferFrom(IERC20 token, address from, address to, uint value) internal {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        callOptionalReturn(token, abi.encodeWithSelector(token.transferFrom.selector, from, to, value));</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    function safeApprove(IERC20 token, address spender, uint value) internal {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        require((value == 0) || (token.allowance(address(this), spender) == 0),</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            &quot;SafeERC20: approve from non-zero to non-zero allowance&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        );</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        callOptionalReturn(token, abi.encodeWithSelector(token.approve.selector, spender, value));</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    function callOptionalReturn(IERC20 token, bytes memory data) private {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        require(address(token).isContract(), &quot;SafeERC20: call to non-contract&quot;);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        // solhint-disable-next-line avoid-low-level-calls</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        (bool success, bytes memory returndata) = address(token).call(data);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        require(success, &quot;SafeERC20: low-level call failed&quot;);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        if (returndata.length &gt; 0) { // Return data is optional</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            // solhint-disable-next-line max-line-length</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            require(abi.decode(returndata, (bool)), &quot;SafeERC20: ERC20 operation did not succeed&quot;);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">contract ORC is ERC20, ERC20Detailed {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    using SafeERC20 for IERC20;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    using Address for address;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    using SafeMath for uint;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    address public governance;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    mapping (address =&gt; bool) public minters;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    constructor () public ERC20Detailed(&quot;OrcaDeFi&quot;, &quot;ORC&quot;, 18) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        governance = msg.sender;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    function mint(address account, uint amount) public {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        require(minters[msg.sender], &quot;!minter&quot;);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        _mint(account, amount);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    function setGovernance(address _governance) public {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        require(msg.sender == governance, &quot;!governance&quot;);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        governance = _governance;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    function addMinter(address _minter) public {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        require(msg.sender == governance, &quot;!governance&quot;);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        minters[_minter] = true;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    function removeMinter(address _minter) public {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        require(msg.sender == governance, &quot;!governance&quot;);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        minters[_minter] = false;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div></div></div></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="governance-token"></a>Governance Token<a aria-hidden="true" tabindex="-1" class="hash-link" href="#governance-token" title="Direct link to heading">#</a></h3><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-bash codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">pragma solidity ^0.5.16</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">library SafeMath </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">function</span><span class="token plain"> add</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">uint a, uint b</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> internal pure returns </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">uint</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        uint c </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> a + b</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        require</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">c </span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> a, </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;SafeMath: addition overflow&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">return</span><span class="token plain"> c</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">function</span><span class="token plain"> sub</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">uint a, uint b</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> internal pure returns </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">uint</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">return</span><span class="token plain"> sub</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">a, b, </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;SafeMath: subtraction overflow&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">function</span><span class="token plain"> sub</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">uint a, uint b, string memory errorMessage</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> internal pure returns </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">uint</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        require</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">b </span><span class="token operator" style="color:rgb(137, 221, 255)">&lt;</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> a, errorMessage</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        uint c </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> a - b</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">return</span><span class="token plain"> c</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">function</span><span class="token plain"> mul</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">uint a, uint b</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> internal pure returns </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">uint</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token keyword" style="font-style:italic">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">a </span><span class="token operator" style="color:rgb(137, 221, 255)">==</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">return</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        uint c </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> a * b</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        require</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">c / a </span><span class="token operator" style="color:rgb(137, 221, 255)">==</span><span class="token plain"> b, </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;SafeMath: multiplication overflow&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">return</span><span class="token plain"> c</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">function</span><span class="token plain"> div</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">uint a, uint b</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> internal pure returns </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">uint</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">return</span><span class="token plain"> div</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">a, b, </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;SafeMath: division by zero&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">function</span><span class="token plain"> div</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">uint a, uint b, string memory errorMessage</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> internal pure returns </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">uint</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        // Solidity only automatically asserts when dividing by </span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        require</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">b </span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token plain">, errorMessage</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        uint c </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> a / b</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">return</span><span class="token plain"> c</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">interface Gov </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">function</span><span class="token plain"> setGovernance</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">address</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> external</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">contract TimelockGovernance </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    using SafeMath </span><span class="token keyword" style="font-style:italic">for</span><span class="token plain"> uint</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    uint public period </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">17280</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"> // voting period </span><span class="token keyword" style="font-style:italic">in</span><span class="token plain"> blocks ~ </span><span class="token number" style="color:rgb(247, 140, 108)">17280</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">3</span><span class="token plain"> days </span><span class="token keyword" style="font-style:italic">for</span><span class="token plain"> 15s/block</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    address public governance</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    address public newGovernance</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    uint public newGovernanceUpdatable</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    address public target</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    address public newTargetGovernance</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    uint public newTargetGovernanceUpdatable</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    constructor</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">address _multisig, address _target</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> public </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        governance </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> _multisig</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        newGovernance </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> governance</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        target </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> _target</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        newTargetGovernance </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> address</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">this</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">function</span><span class="token plain"> setThisGovernance</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">address _governance</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> external </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        require</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">governance </span><span class="token operator" style="color:rgb(137, 221, 255)">==</span><span class="token plain"> msg.sender</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        newGovernanceUpdatable </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> period.add</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">block.number</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        newGovernance </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> _governance</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">function</span><span class="token plain"> updateThisGovernance</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> external </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        require</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">newGovernanceUpdatable </span><span class="token operator" style="color:rgb(137, 221, 255)">&lt;</span><span class="token plain"> block.number, </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;&lt;block.number&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        governance </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> newGovernance</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">function</span><span class="token plain"> setTargetGovernance</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">address _governance</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> external </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        require</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">governance </span><span class="token operator" style="color:rgb(137, 221, 255)">==</span><span class="token plain"> msg.sender</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        newTargetGovernanceUpdatable </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> period.add</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">block.number</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        newTargetGovernance </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> _governance</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">function</span><span class="token plain"> updateTargetGovernance</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> external </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        require</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">newTargetGovernanceUpdatable </span><span class="token operator" style="color:rgb(137, 221, 255)">&lt;</span><span class="token plain"> block.number, </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;&lt;block.number&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        Gov</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">target</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain">.setGovernance</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">newTargetGovernance</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span></div></div></div></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="governance-proxy"></a>Governance Proxy<a aria-hidden="true" tabindex="-1" class="hash-link" href="#governance-proxy" title="Direct link to heading">#</a></h3><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-bash codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">pragma solidity ^0.5.3</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">/// @title Proxy - Generic proxy contract allows to execute all transactions applying the code of a master contract.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">/// @author Stefan George - </span><span class="token operator" style="color:rgb(137, 221, 255)">&lt;</span><span class="token plain">stefan@gnosis.io</span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">/// @author Richard Meissner - </span><span class="token operator" style="color:rgb(137, 221, 255)">&lt;</span><span class="token plain">richard@gnosis.io</span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">contract Proxy </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    // masterCopy always needs to be first declared variable, to ensure that it is at the same location </span><span class="token keyword" style="font-style:italic">in</span><span class="token plain"> the contracts to </span><span class="token function" style="color:rgb(130, 170, 255)">which</span><span class="token plain"> calls are delegated.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    // To reduce deployment costs this variable is internal and needs to be retrieved via </span><span class="token variable" style="color:rgb(191, 199, 213)">`</span><span class="token variable" style="color:rgb(191, 199, 213)">getStorageAt</span><span class="token variable" style="color:rgb(191, 199, 213)">`</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    address internal masterCopy</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    /// @dev Constructor </span><span class="token keyword" style="font-style:italic">function</span><span class="token plain"> sets address of master copy contract.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    /// @param _masterCopy Master copy address.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    constructor</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">address _masterCopy</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    public</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        require</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">_masterCopy </span><span class="token operator" style="color:rgb(137, 221, 255)">!=</span><span class="token plain"> address</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain">, </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;Invalid master copy address provided&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        masterCopy </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> _masterCopy</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    /// @dev Fallback </span><span class="token keyword" style="font-style:italic">function</span><span class="token plain"> forwards all transactions and returns all received </span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">return</span><span class="token plain"> data.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">function</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    external</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    payable</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        // solium-disable-next-line security/no-inline-assembly</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        assembly </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">let</span><span class="token plain"> masterCopy :</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> and</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">sload</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain">, 0xffffffffffffffffffffffffffffffffffffffff</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        // 0xa619486e </span><span class="token operator" style="color:rgb(137, 221, 255)">==</span><span class="token plain"> keccak</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;masterCopy()&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain">. The value is right padded to </span><span class="token number" style="color:rgb(247, 140, 108)">32</span><span class="token plain">-bytes with 0s</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token keyword" style="font-style:italic">if</span><span class="token plain"> eq</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">calldataload</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain">, 0xa00000000000000000000000000000000000000000000000000000000</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                mstore</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token plain">, masterCopy</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                return</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token plain">, 0x20</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            calldatacopy</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token plain">, </span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token plain">, calldatasize</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">))</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">let</span><span class="token plain"> success :</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> delegatecall</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">gas, masterCopy, </span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token plain">, calldatasize</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain">, </span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token plain">, </span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            returndatacopy</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token plain">, </span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token plain">, returndatasize</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">))</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token keyword" style="font-style:italic">if</span><span class="token plain"> eq</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">success, </span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"> revert</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token plain">, returndatasize</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">))</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            return</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token plain">, returndatasize</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">))</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span></div></div></div></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="governance-protocol"></a>Governance Protocol<a aria-hidden="true" tabindex="-1" class="hash-link" href="#governance-protocol" title="Direct link to heading">#</a></h3><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-pragma codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">/// @title SelfAuthorized - authorizes current contract to perform actions</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">/// @author Richard Meissner - &lt;richard@gnosis.pm&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">contract SelfAuthorized {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    modifier authorized() {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        require(msg.sender == address(this), &quot;Method can only be called from this contract&quot;);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        _;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">/// @title MasterCopy - Base for master copy contracts (should always be first super contract)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">///         This contract is tightly coupled to our proxy contract (see `proxies/Proxy.sol`)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">/// @author Richard Meissner - &lt;richard@gnosis.io&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">contract MasterCopy is SelfAuthorized {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    event ChangedMasterCopy(address masterCopy);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    // masterCopy always needs to be first declared variable, to ensure that it is at the same location as in the Proxy contract.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    // It should also always be ensured that the address is stored alone (uses a full word)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    address private masterCopy;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    /// @dev Allows to upgrade the contract. This can only be done via a Safe transaction.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    /// @param _masterCopy New contract address.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    function changeMasterCopy(address _masterCopy)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    public</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    authorized</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        // Master copy address cannot be null.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        require(_masterCopy != address(0), &quot;Invalid master copy address provided&quot;);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        masterCopy = _masterCopy;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        emit ChangedMasterCopy(_masterCopy);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">/// @title Module - Base class for modules.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">/// @author Stefan George - &lt;stefan@gnosis.pm&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">/// @author Richard Meissner - &lt;richard@gnosis.pm&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">contract Module is MasterCopy {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    ModuleManager public manager;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    modifier authorized() {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        require(msg.sender == address(manager), &quot;Method can only be called from manager&quot;);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        _;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    function setManager()</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    internal</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        // manager can only be 0 at initalization of contract.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        // Check ensures that setup function can only be called once.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        require(address(manager) == address(0), &quot;Manager has already been set&quot;);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        manager = ModuleManager(msg.sender);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">/// @title Enum - Collection of enums</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">/// @author Richard Meissner - &lt;richard@gnosis.pm&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">contract Enum {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    enum Operation {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        Call,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        DelegateCall</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">/// @title Executor - A contract that can execute transactions</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">/// @author Richard Meissner - &lt;richard@gnosis.pm&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">contract Executor {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    function execute(address to, uint256 value, bytes memory data, Enum.Operation operation, uint256 txGas)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    internal</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    returns (bool success)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        if (operation == Enum.Operation.Call)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            success = executeCall(to, value, data, txGas);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        else if (operation == Enum.Operation.DelegateCall)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            success = executeDelegateCall(to, data, txGas);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        else</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            success = false;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    function executeCall(address to, uint256 value, bytes memory data, uint256 txGas)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    internal</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    returns (bool success)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        // solium-disable-next-line security/no-inline-assembly</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        assembly {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            success := call(txGas, to, value, add(data, 0x20), mload(data), 0, 0)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    function executeDelegateCall(address to, bytes memory data, uint256 txGas)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    internal</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    returns (bool success)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        // solium-disable-next-line security/no-inline-assembly</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        assembly {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            success := delegatecall(txGas, to, add(data, 0x20), mload(data), 0, 0)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">/// @title SecuredTokenTransfer - Secure token transfer</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">/// @author Richard Meissner - &lt;richard@gnosis.pm&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">contract SecuredTokenTransfer {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    /// @dev Transfers a token and returns if it was a success</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    /// @param token Token that should be transferred</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    /// @param receiver Receiver to whom the token should be transferred</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    /// @param amount The amount of tokens that should be transferred</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    function transferToken (</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        address token,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        address receiver,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        uint256 amount</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    )</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    internal</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    returns (bool transferred)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        bytes memory data = abi.encodeWithSignature(&quot;transfer(address,uint256)&quot;, receiver, amount);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        // solium-disable-next-line security/no-inline-assembly</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        assembly {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            let success := call(sub(gas, 10000), token, 0, add(data, 0x20), mload(data), 0, 0)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            let ptr := mload(0x40)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            mstore(0x40, add(ptr, returndatasize()))</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            returndatacopy(ptr, 0, returndatasize())</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            switch returndatasize()</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            case 0 { transferred := success }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            case 0x20 { transferred := iszero(or(iszero(success), iszero(mload(ptr)))) }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            default { transferred := 0 }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">/// @title Module Manager - A contract that manages modules that can execute transactions via this contract</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">/// @author Stefan George - &lt;stefan@gnosis.pm&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">/// @author Richard Meissner - &lt;richard@gnosis.pm&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">contract ModuleManager is SelfAuthorized, Executor {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    event EnabledModule(Module module);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    event DisabledModule(Module module);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    event ExecutionFromModuleSuccess(address indexed module);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    event ExecutionFromModuleFailure(address indexed module);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    address internal constant SENTINEL_MODULES = address(0x1);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    mapping (address =&gt; address) internal modules;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    function setupModules(address to, bytes memory data)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    internal</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        require(modules[SENTINEL_MODULES] == address(0), &quot;Modules have already been initialized&quot;);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        modules[SENTINEL_MODULES] = SENTINEL_MODULES;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        if (to != address(0))</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        // Setup has to complete successfully or transaction fails.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            require(executeDelegateCall(to, data, gasleft()), &quot;Could not finish initialization&quot;);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    /// @dev Allows to add a module to the whitelist.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    ///      This can only be done via a Safe transaction.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    /// @param module Module to be whitelisted.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    function enableModule(Module module)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    public</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    authorized</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        // Module address cannot be null or sentinel.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        require(address(module) != address(0) &amp;&amp; address(module) != SENTINEL_MODULES, &quot;Invalid module address provided&quot;);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        // Module cannot be added twice.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        require(modules[address(module)] == address(0), &quot;Module has already been added&quot;);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        modules[address(module)] = modules[SENTINEL_MODULES];</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        modules[SENTINEL_MODULES] = address(module);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        emit EnabledModule(module);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    /// @dev Allows to remove a module from the whitelist.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    ///      This can only be done via a Safe transaction.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    /// @param prevModule Module that pointed to the module to be removed in the linked list</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    /// @param module Module to be removed.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    function disableModule(Module prevModule, Module module)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    public</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    authorized</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        // Validate module address and check that it corresponds to module index.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        require(address(module) != address(0) &amp;&amp; address(module) != SENTINEL_MODULES, &quot;Invalid module address provided&quot;);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        require(modules[address(prevModule)] == address(module), &quot;Invalid prevModule, module pair provided&quot;);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        modules[address(prevModule)] = modules[address(module)];</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        modules[address(module)] = address(0);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        emit DisabledModule(module);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    /// @dev Allows a Module to execute a Safe transaction without any further confirmations.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    /// @param to Destination address of module transaction.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    /// @param value Ether value of module transaction.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    /// @param data Data payload of module transaction.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    /// @param operation Operation type of module transaction.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    function execTransactionFromModule(address to, uint256 value, bytes memory data, Enum.Operation operation)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    public</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    returns (bool success)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        // Only whitelisted modules are allowed.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        require(msg.sender != SENTINEL_MODULES &amp;&amp; modules[msg.sender] != address(0), &quot;Method can only be called from an enabled module&quot;);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        // Execute transaction without further confirmations.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        success = execute(to, value, data, operation, gasleft());</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        if (success) emit ExecutionFromModuleSuccess(msg.sender);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        else emit ExecutionFromModuleFailure(msg.sender);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    /// @dev Allows a Module to execute a Safe transaction without any further confirmations and return data</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    /// @param to Destination address of module transaction.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    /// @param value Ether value of module transaction.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    /// @param data Data payload of module transaction.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    /// @param operation Operation type of module transaction.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    function execTransactionFromModuleReturnData(address to, uint256 value, bytes memory data, Enum.Operation operation)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    public</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    returns (bool success, bytes memory returnData)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        success = execTransactionFromModule(to, value, data, operation);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        // solium-disable-next-line security/no-inline-assembly</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        assembly {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        // Load free memory location</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            let ptr := mload(0x40)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        // We allocate memory for the return data by setting the free memory location to</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        // current free memory location + data size + 32 bytes for data size value</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            mstore(0x40, add(ptr, add(returndatasize(), 0x20)))</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        // Store the size</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            mstore(ptr, returndatasize())</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        // Store the data</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            returndatacopy(add(ptr, 0x20), 0, returndatasize())</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        // Point the return data to the correct memory location</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            returnData := ptr</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    /// @dev Returns array of first 10 modules.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    /// @return Array of modules.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    function getModules()</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    public</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    view</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    returns (address[] memory)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        (address[] memory array,) = getModulesPaginated(SENTINEL_MODULES, 10);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        return array;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    /// @dev Returns array of modules.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    /// @param start Start of the page.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    /// @param pageSize Maximum number of modules that should be returned.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    /// @return Array of modules.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    function getModulesPaginated(address start, uint256 pageSize)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    public</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    view</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    returns (address[] memory array, address next)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        // Init array with max page size</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        array = new address[](pageSize);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        // Populate return array</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        uint256 moduleCount = 0;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        address currentModule = modules[start];</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        while(currentModule != address(0x0) &amp;&amp; currentModule != SENTINEL_MODULES &amp;&amp; moduleCount &lt; pageSize) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            array[moduleCount] = currentModule;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            currentModule = modules[currentModule];</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            moduleCount++;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        next = currentModule;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        // Set correct size of returned array</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        // solium-disable-next-line security/no-inline-assembly</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        assembly {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            mstore(array, moduleCount)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">/// @title OwnerManager - Manages a set of owners and a threshold to perform actions.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">/// @author Stefan George - &lt;stefan@gnosis.pm&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">/// @author Richard Meissner - &lt;richard@gnosis.pm&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">contract OwnerManager is SelfAuthorized {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    event AddedOwner(address owner);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    event RemovedOwner(address owner);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    event ChangedThreshold(uint256 threshold);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    address internal constant SENTINEL_OWNERS = address(0x1);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    mapping(address =&gt; address) internal owners;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    uint256 ownerCount;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    uint256 internal threshold;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    /// @dev Setup function sets initial storage of contract.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    /// @param _owners List of Safe owners.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    /// @param _threshold Number of required confirmations for a Safe transaction.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    function setupOwners(address[] memory _owners, uint256 _threshold)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    internal</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        // Threshold can only be 0 at initialization.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        // Check ensures that setup function can only be called once.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        require(threshold == 0, &quot;Owners have already been setup&quot;);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        // Validate that threshold is smaller than number of added owners.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        require(_threshold &lt;= _owners.length, &quot;Threshold cannot exceed owner count&quot;);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        // There has to be at least one Safe owner.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        require(_threshold &gt;= 1, &quot;Threshold needs to be greater than 0&quot;);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        // Initializing Safe owners.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        address currentOwner = SENTINEL_OWNERS;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        for (uint256 i = 0; i &lt; _owners.length; i++) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            // Owner address cannot be null.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            address owner = _owners[i];</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            require(owner != address(0) &amp;&amp; owner != SENTINEL_OWNERS, &quot;Invalid owner address provided&quot;);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            // No duplicate owners allowed.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            require(owners[owner] == address(0), &quot;Duplicate owner address provided&quot;);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            owners[currentOwner] = owner;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            currentOwner = owner;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        owners[currentOwner] = SENTINEL_OWNERS;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        ownerCount = _owners.length;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        threshold = _threshold;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    /// @dev Allows to add a new owner to the Safe and update the threshold at the same time.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    ///      This can only be done via a Safe transaction.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    /// @param owner New owner address.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    /// @param _threshold New threshold.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    function addOwnerWithThreshold(address owner, uint256 _threshold)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    public</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    authorized</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        // Owner address cannot be null.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        require(owner != address(0) &amp;&amp; owner != SENTINEL_OWNERS, &quot;Invalid owner address provided&quot;);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        // No duplicate owners allowed.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        require(owners[owner] == address(0), &quot;Address is already an owner&quot;);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        owners[owner] = owners[SENTINEL_OWNERS];</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        owners[SENTINEL_OWNERS] = owner;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        ownerCount++;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        emit AddedOwner(owner);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        // Change threshold if threshold was changed.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        if (threshold != _threshold)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            changeThreshold(_threshold);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    /// @dev Allows to remove an owner from the Safe and update the threshold at the same time.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    ///      This can only be done via a Safe transaction.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    /// @param prevOwner Owner that pointed to the owner to be removed in the linked list</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    /// @param owner Owner address to be removed.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    /// @param _threshold New threshold.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    function removeOwner(address prevOwner, address owner, uint256 _threshold)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    public</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    authorized</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        // Only allow to remove an owner, if threshold can still be reached.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        require(ownerCount - 1 &gt;= _threshold, &quot;New owner count needs to be larger than new threshold&quot;);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        // Validate owner address and check that it corresponds to owner index.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        require(owner != address(0) &amp;&amp; owner != SENTINEL_OWNERS, &quot;Invalid owner address provided&quot;);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        require(owners[prevOwner] == owner, &quot;Invalid prevOwner, owner pair provided&quot;);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        owners[prevOwner] = owners[owner];</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        owners[owner] = address(0);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        ownerCount--;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        emit RemovedOwner(owner);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        // Change threshold if threshold was changed.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        if (threshold != _threshold)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            changeThreshold(_threshold);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    /// @dev Allows to swap/replace an owner from the Safe with another address.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    ///      This can only be done via a Safe transaction.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    /// @param prevOwner Owner that pointed to the owner to be replaced in the linked list</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    /// @param oldOwner Owner address to be replaced.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    /// @param newOwner New owner address.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    function swapOwner(address prevOwner, address oldOwner, address newOwner)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    public</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    authorized</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        // Owner address cannot be null.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        require(newOwner != address(0) &amp;&amp; newOwner != SENTINEL_OWNERS, &quot;Invalid owner address provided&quot;);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        // No duplicate owners allowed.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        require(owners[newOwner] == address(0), &quot;Address is already an owner&quot;);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        // Validate oldOwner address and check that it corresponds to owner index.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        require(oldOwner != address(0) &amp;&amp; oldOwner != SENTINEL_OWNERS, &quot;Invalid owner address provided&quot;);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        require(owners[prevOwner] == oldOwner, &quot;Invalid prevOwner, owner pair provided&quot;);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        owners[newOwner] = owners[oldOwner];</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        owners[prevOwner] = newOwner;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        owners[oldOwner] = address(0);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        emit RemovedOwner(oldOwner);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        emit AddedOwner(newOwner);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    /// @dev Allows to update the number of required confirmations by Safe owners.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    ///      This can only be done via a Safe transaction.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    /// @param _threshold New threshold.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    function changeThreshold(uint256 _threshold)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    public</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    authorized</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        // Validate that threshold is smaller than number of owners.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        require(_threshold &lt;= ownerCount, &quot;Threshold cannot exceed owner count&quot;);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        // There has to be at least one Safe owner.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        require(_threshold &gt;= 1, &quot;Threshold needs to be greater than 0&quot;);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        threshold = _threshold;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        emit ChangedThreshold(threshold);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    function getThreshold()</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    public</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    view</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    returns (uint256)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        return threshold;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    function isOwner(address owner)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    public</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    view</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    returns (bool)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        return owner != SENTINEL_OWNERS &amp;&amp; owners[owner] != address(0);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    /// @dev Returns array of owners.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    /// @return Array of Safe owners.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    function getOwners()</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    public</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    view</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    returns (address[] memory)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        address[] memory array = new address[](ownerCount);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        // populate return array</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        uint256 index = 0;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        address currentOwner = owners[SENTINEL_OWNERS];</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        while(currentOwner != SENTINEL_OWNERS) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            array[index] = currentOwner;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            currentOwner = owners[currentOwner];</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            index ++;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        return array;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">/// @title Fallback Manager - A contract that manages fallback calls made to this contract</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">/// @author Richard Meissner - &lt;richard@gnosis.pm&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">contract FallbackManager is SelfAuthorized {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    // keccak256(&quot;fallback_manager.handler.address&quot;)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    bytes32 internal constant FALLBACK_HANDLER_STORAGE_SLOT = 0x6c9a6c4a39284e37ed1cf53d337577d14212a4870fb976a4366c693b939918d5;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    function internalSetFallbackHandler(address handler) internal {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        bytes32 slot = FALLBACK_HANDLER_STORAGE_SLOT;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        // solium-disable-next-line security/no-inline-assembly</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        assembly {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            sstore(slot, handler)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    /// @dev Allows to add a contract to handle fallback calls.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    ///      Only fallback calls without value and with data will be forwarded.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    ///      This can only be done via a Safe transaction.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    /// @param handler contract to handle fallbacks calls.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    function setFallbackHandler(address handler)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    public</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    authorized</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        internalSetFallbackHandler(handler);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    function ()</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    external</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    payable</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        // Only calls without value and with data will be forwarded</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        if (msg.value &gt; 0 || msg.data.length == 0) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            return;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        bytes32 slot = FALLBACK_HANDLER_STORAGE_SLOT;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        address handler;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        // solium-disable-next-line security/no-inline-assembly</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        assembly {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            handler := sload(slot)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        if (handler != address(0)) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            // solium-disable-next-line security/no-inline-assembly</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            assembly {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                calldatacopy(0, 0, calldatasize())</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                let success := call(gas, handler, 0, 0, calldatasize(), 0, 0)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                returndatacopy(0, 0, returndatasize())</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                if eq(success, 0) { revert(0, returndatasize()) }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                return(0, returndatasize())</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">/// @title SignatureDecoder - Decodes signatures that a encoded as bytes</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">/// @author Ricardo Guilherme Schmidt (Status Research &amp; Development GmbH)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">/// @author Richard Meissner - &lt;richard@gnosis.pm&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">contract SignatureDecoder {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    /// @dev Recovers address who signed the message</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    /// @param messageHash operation ethereum signed message hash</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    /// @param messageSignature message `txHash` signature</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    /// @param pos which signature to read</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    function recoverKey (</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        bytes32 messageHash,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        bytes memory messageSignature,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        uint256 pos</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    )</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    internal</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    pure</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    returns (address)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        uint8 v;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        bytes32 r;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        bytes32 s;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        (v, r, s) = signatureSplit(messageSignature, pos);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        return ecrecover(messageHash, v, r, s);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    /// @dev divides bytes signature into `uint8 v, bytes32 r, bytes32 s`.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    /// @notice Make sure to peform a bounds check for @param pos, to avoid out of bounds access on @param signatures</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    /// @param pos which signature to read. A prior bounds check of this parameter should be performed, to avoid out of bounds access</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    /// @param signatures concatenated rsv signatures</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    function signatureSplit(bytes memory signatures, uint256 pos)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    internal</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    pure</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    returns (uint8 v, bytes32 r, bytes32 s)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        // The signature format is a compact form of:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        //   {bytes32 r}{bytes32 s}{uint8 v}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        // Compact means, uint8 is not padded to 32 bytes.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        // solium-disable-next-line security/no-inline-assembly</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        assembly {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            let signaturePos := mul(0x41, pos)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            r := mload(add(signatures, add(signaturePos, 0x20)))</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            s := mload(add(signatures, add(signaturePos, 0x40)))</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        // Here we are loading the last 32 bytes, including 31 bytes</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        // of &#x27;s&#x27;. There is no &#x27;mload8&#x27; to do this.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        //</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        // &#x27;byte&#x27; is not working due to the Solidity parser, so lets</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        // use the second best option, &#x27;and&#x27;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            v := and(mload(add(signatures, add(signaturePos, 0x41))), 0xff)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">contract ISignatureValidatorConstants {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    // bytes4(keccak256(&quot;isValidSignature(bytes,bytes)&quot;)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    bytes4 constant internal EIP1271_MAGIC_VALUE = 0x20c13b0b;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">contract ISignatureValidator is ISignatureValidatorConstants {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    /**</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    * @dev Should return whether the signature provided is valid for the provided data</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    * @param _data Arbitrary length data signed on the behalf of address(this)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    * @param _signature Signature byte array associated with _data</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    *</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    * MUST return the bytes4 magic value 0x20c13b0b when function passes.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    * MUST NOT modify state (using STATICCALL for solc &lt; 0.5, view modifier for solc &gt; 0.5)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    * MUST allow external calls</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    */</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    function isValidSignature(</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        bytes memory _data,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        bytes memory _signature)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    public</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    view</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    returns (bytes4);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">/**</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> * @title SafeMath</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> * @dev Math operations with safety checks that revert on error</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> * TODO: remove once open zeppelin update to solc 0.5.0</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> */</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">library SafeMath {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    /**</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    * @dev Multiplies two numbers, reverts on overflow.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    */</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    function mul(uint256 a, uint256 b) internal pure returns (uint256) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        // Gas optimization: this is cheaper than requiring &#x27;a&#x27; not being zero, but the</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        // benefit is lost if &#x27;b&#x27; is also tested.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        // See: https://github.com/OpenZeppelin/openzeppelin-solidity/pull/522</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        if (a == 0) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            return 0;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        uint256 c = a * b;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        require(c / a == b);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        return c;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    /**</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    * @dev Integer division of two numbers truncating the quotient, reverts on division by zero.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    */</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    function div(uint256 a, uint256 b) internal pure returns (uint256) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        require(b &gt; 0); // Solidity only automatically asserts when dividing by 0</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        uint256 c = a / b;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        // assert(a == b * c + a % b); // There is no case in which this doesn&#x27;t hold</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        return c;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    /**</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    * @dev Subtracts two numbers, reverts on overflow (i.e. if subtrahend is greater than minuend).</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    */</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    function sub(uint256 a, uint256 b) internal pure returns (uint256) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        require(b &lt;= a);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        uint256 c = a - b;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        return c;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    /**</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    * @dev Adds two numbers, reverts on overflow.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    */</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    function add(uint256 a, uint256 b) internal pure returns (uint256) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        uint256 c = a + b;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        require(c &gt;= a);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        return c;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    /**</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    * @dev Divides two numbers and returns the remainder (unsigned integer modulo),</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    * reverts when dividing by zero.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    */</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    function mod(uint256 a, uint256 b) internal pure returns (uint256) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        require(b != 0);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        return a % b;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">/// @title Gnosis Safe - A multisignature wallet with support for confirmations using signed messages based on ERC191.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">/// @author Stefan George - &lt;stefan@gnosis.io&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">/// @author Richard Meissner - &lt;richard@gnosis.io&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">/// @author Ricardo Guilherme Schmidt - (Status Research &amp; Development GmbH) - Gas Token Payment</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">contract GnosisSafe</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">is MasterCopy, ModuleManager, OwnerManager, SignatureDecoder, SecuredTokenTransfer, ISignatureValidatorConstants, FallbackManager {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    using SafeMath for uint256;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    string public constant NAME = &quot;Gnosis Safe&quot;;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    string public constant VERSION = &quot;1.1.1&quot;;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    //keccak256(</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    //    &quot;EIP712Domain(address verifyingContract)&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    //);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    bytes32 private constant DOMAIN_SEPARATOR_TYPEHASH = 0x035aff83d86937d35b32e04f0ddc6ff469290eef2f1b692d8a815c89404d4749;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    //keccak256(</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    //    &quot;SafeTx(address to,uint256 value,bytes data,uint8 operation,uint256 safeTxGas,uint256 baseGas,uint256 gasPrice,address gasToken,address refundReceiver,uint256 nonce)&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    //);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    bytes32 private constant SAFE_TX_TYPEHASH = 0xbb8310d486368db6bd6f849402fdd73ad53d316b5a4b2644ad6efe0f941286d8;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    //keccak256(</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    //    &quot;SafeMessage(bytes message)&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    //);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    bytes32 private constant SAFE_MSG_TYPEHASH = 0x60b3cbf8b4a223d68d641b3b6ddf9a298e7f33710cf3d3a9d1146b5a6150fbca;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    event ApproveHash(</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        bytes32 indexed approvedHash,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        address indexed owner</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    );</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    event SignMsg(</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        bytes32 indexed msgHash</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    );</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    event ExecutionFailure(</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        bytes32 txHash, uint256 payment</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    );</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    event ExecutionSuccess(</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        bytes32 txHash, uint256 payment</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    );</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    uint256 public nonce;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    bytes32 public domainSeparator;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    // Mapping to keep track of all message hashes that have been approve by ALL REQUIRED owners</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    mapping(bytes32 =&gt; uint256) public signedMessages;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    // Mapping to keep track of all hashes (message or transaction) that have been approve by ANY owners</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    mapping(address =&gt; mapping(bytes32 =&gt; uint256)) public approvedHashes;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    // This constructor ensures that this contract can only be used as a master copy for Proxy contracts</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    constructor() public {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        // By setting the threshold it is not possible to call setup anymore,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        // so we create a Safe with 0 owners and threshold 1.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        // This is an unusable Safe, perfect for the mastercopy</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        threshold = 1;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    /// @dev Setup function sets initial storage of contract.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    /// @param _owners List of Safe owners.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    /// @param _threshold Number of required confirmations for a Safe transaction.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    /// @param to Contract address for optional delegate call.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    /// @param data Data payload for optional delegate call.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    /// @param fallbackHandler Handler for fallback calls to this contract</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    /// @param paymentToken Token that should be used for the payment (0 is ETH)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    /// @param payment Value that should be paid</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    /// @param paymentReceiver Adddress that should receive the payment (or 0 if tx.origin)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    function setup(</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        address[] calldata _owners,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        uint256 _threshold,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        address to,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        bytes calldata data,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        address fallbackHandler,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        address paymentToken,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        uint256 payment,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        address payable paymentReceiver</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    )</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    external</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        require(domainSeparator == 0, &quot;Domain Separator already set!&quot;);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        domainSeparator = keccak256(abi.encode(DOMAIN_SEPARATOR_TYPEHASH, this));</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        setupOwners(_owners, _threshold);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        if (fallbackHandler != address(0)) internalSetFallbackHandler(fallbackHandler);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        // As setupOwners can only be called if the contract has not been initialized we don&#x27;t need a check for setupModules</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        setupModules(to, data);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        if (payment &gt; 0) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            // To avoid running into issues with EIP-170 we reuse the handlePayment function (to avoid adjusting code of that has been verified we do not adjust the method itself)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            // baseGas = 0, gasPrice = 1 and gas = payment =&gt; amount = (payment + 0) * 1 = payment</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            handlePayment(payment, 0, 1, paymentToken, paymentReceiver);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    /// @dev Allows to execute a Safe transaction confirmed by required number of owners and then pays the account that submitted the transaction.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    ///      Note: The fees are always transfered, even if the user transaction fails.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    /// @param to Destination address of Safe transaction.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    /// @param value Ether value of Safe transaction.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    /// @param data Data payload of Safe transaction.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    /// @param operation Operation type of Safe transaction.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    /// @param safeTxGas Gas that should be used for the Safe transaction.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    /// @param baseGas Gas costs for that are indipendent of the transaction execution(e.g. base transaction fee, signature check, payment of the refund)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    /// @param gasPrice Gas price that should be used for the payment calculation.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    /// @param gasToken Token address (or 0 if ETH) that is used for the payment.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    /// @param refundReceiver Address of receiver of gas payment (or 0 if tx.origin).</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    /// @param signatures Packed signature data ({bytes32 r}{bytes32 s}{uint8 v})</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    function execTransaction(</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        address to,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        uint256 value,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        bytes calldata data,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        Enum.Operation operation,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        uint256 safeTxGas,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        uint256 baseGas,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        uint256 gasPrice,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        address gasToken,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        address payable refundReceiver,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        bytes calldata signatures</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    )</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    external</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    returns (bool success)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        bytes32 txHash;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        // Use scope here to limit variable lifetime and prevent `stack too deep` errors</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            bytes memory txHashData = encodeTransactionData(</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                to, value, data, operation, // Transaction info</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                safeTxGas, baseGas, gasPrice, gasToken, refundReceiver, // Payment info</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                nonce</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            );</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            // Increase nonce and execute transaction.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            nonce++;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            txHash = keccak256(txHashData);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            checkSignatures(txHash, txHashData, signatures, true);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        require(gasleft() &gt;= safeTxGas, &quot;Not enough gas to execute safe transaction&quot;);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        // Use scope here to limit variable lifetime and prevent `stack too deep` errors</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            uint256 gasUsed = gasleft();</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            // If no safeTxGas has been set and the gasPrice is 0 we assume that all available gas can be used</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            success = execute(to, value, data, operation, safeTxGas == 0 &amp;&amp; gasPrice == 0 ? gasleft() : safeTxGas);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            gasUsed = gasUsed.sub(gasleft());</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            // We transfer the calculated tx costs to the tx.origin to avoid sending it to intermediate contracts that have made calls</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            uint256 payment = 0;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            if (gasPrice &gt; 0) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                payment = handlePayment(gasUsed, baseGas, gasPrice, gasToken, refundReceiver);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            if (success) emit ExecutionSuccess(txHash, payment);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            else emit ExecutionFailure(txHash, payment);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    function handlePayment(</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        uint256 gasUsed,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        uint256 baseGas,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        uint256 gasPrice,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        address gasToken,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        address payable refundReceiver</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    )</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    private</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    returns (uint256 payment)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        // solium-disable-next-line security/no-tx-origin</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        address payable receiver = refundReceiver == address(0) ? tx.origin : refundReceiver;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        if (gasToken == address(0)) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            // For ETH we will only adjust the gas price to not be higher than the actual used gas price</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            payment = gasUsed.add(baseGas).mul(gasPrice &lt; tx.gasprice ? gasPrice : tx.gasprice);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            // solium-disable-next-line security/no-send</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            require(receiver.send(payment), &quot;Could not pay gas costs with ether&quot;);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        } else {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            payment = gasUsed.add(baseGas).mul(gasPrice);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            require(transferToken(gasToken, receiver, payment), &quot;Could not pay gas costs with token&quot;);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    /**</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    * @dev Checks whether the signature provided is valid for the provided data, hash. Will revert otherwise.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    * @param dataHash Hash of the data (could be either a message hash or transaction hash)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    * @param data That should be signed (this is passed to an external validator contract)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    * @param signatures Signature data that should be verified. Can be ECDSA signature, contract signature (EIP-1271) or approved hash.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    * @param consumeHash Indicates that in case of an approved hash the storage can be freed to save gas</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    */</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    function checkSignatures(bytes32 dataHash, bytes memory data, bytes memory signatures, bool consumeHash)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    internal</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        // Load threshold to avoid multiple storage loads</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        uint256 _threshold = threshold;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        // Check that a threshold is set</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        require(_threshold &gt; 0, &quot;Threshold needs to be defined!&quot;);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        // Check that the provided signature data is not too short</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        require(signatures.length &gt;= _threshold.mul(65), &quot;Signatures data too short&quot;);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        // There cannot be an owner with address 0.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        address lastOwner = address(0);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        address currentOwner;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        uint8 v;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        bytes32 r;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        bytes32 s;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        uint256 i;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        for (i = 0; i &lt; _threshold; i++) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            (v, r, s) = signatureSplit(signatures, i);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            // If v is 0 then it is a contract signature</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            if (v == 0) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                // When handling contract signatures the address of the contract is encoded into r</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                currentOwner = address(uint256(r));</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                // Check that signature data pointer (s) is not pointing inside the static part of the signatures bytes</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                // This check is not completely accurate, since it is possible that more signatures than the threshold are send.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                // Here we only check that the pointer is not pointing inside the part that is being processed</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                require(uint256(s) &gt;= _threshold.mul(65), &quot;Invalid contract signature location: inside static part&quot;);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                // Check that signature data pointer (s) is in bounds (points to the length of data -&gt; 32 bytes)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                require(uint256(s).add(32) &lt;= signatures.length, &quot;Invalid contract signature location: length not present&quot;);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                // Check if the contract signature is in bounds: start of data is s + 32 and end is start + signature length</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                uint256 contractSignatureLen;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                // solium-disable-next-line security/no-inline-assembly</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                assembly {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    contractSignatureLen := mload(add(add(signatures, s), 0x20))</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                require(uint256(s).add(32).add(contractSignatureLen) &lt;= signatures.length, &quot;Invalid contract signature location: data not complete&quot;);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                // Check signature</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                bytes memory contractSignature;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                // solium-disable-next-line security/no-inline-assembly</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                assembly {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                // The signature data for contract signatures is appended to the concatenated signatures and the offset is stored in s</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    contractSignature := add(add(signatures, s), 0x20)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                require(ISignatureValidator(currentOwner).isValidSignature(data, contractSignature) == EIP1271_MAGIC_VALUE, &quot;Invalid contract signature provided&quot;);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                // If v is 1 then it is an approved hash</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            } else if (v == 1) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                // When handling approved hashes the address of the approver is encoded into r</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                currentOwner = address(uint256(r));</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                // Hashes are automatically approved by the sender of the message or when they have been pre-approved via a separate transaction</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                require(msg.sender == currentOwner || approvedHashes[currentOwner][dataHash] != 0, &quot;Hash has not been approved&quot;);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                // Hash has been marked for consumption. If this hash was pre-approved free storage</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                if (consumeHash &amp;&amp; msg.sender != currentOwner) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    approvedHashes[currentOwner][dataHash] = 0;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            } else if (v &gt; 30) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                // To support eth_sign and similar we adjust v and hash the messageHash with the Ethereum message prefix before applying ecrecover</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                currentOwner = ecrecover(keccak256(abi.encodePacked(&quot;\x19Ethereum Signed Message:\n32&quot;, dataHash)), v - 4, r, s);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            } else {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                // Use ecrecover with the messageHash for EOA signatures</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                currentOwner = ecrecover(dataHash, v, r, s);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            require (</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                currentOwner &gt; lastOwner &amp;&amp; owners[currentOwner] != address(0) &amp;&amp; currentOwner != SENTINEL_OWNERS,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                &quot;Invalid owner provided&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            );</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            lastOwner = currentOwner;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    /// @dev Allows to estimate a Safe transaction.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    ///      This method is only meant for estimation purpose, therefore two different protection mechanism against execution in a transaction have been made:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    ///      1.) The method can only be called from the safe itself</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    ///      2.) The response is returned with a revert</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    ///      When estimating set `from` to the address of the safe.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    ///      Since the `estimateGas` function includes refunds, call this method to get an estimated of the costs that are deducted from the safe with `execTransaction`</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    /// @param to Destination address of Safe transaction.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    /// @param value Ether value of Safe transaction.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    /// @param data Data payload of Safe transaction.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    /// @param operation Operation type of Safe transaction.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    /// @return Estimate without refunds and overhead fees (base transaction and payload data gas costs).</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    function requiredTxGas(address to, uint256 value, bytes calldata data, Enum.Operation operation)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    external</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    authorized</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    returns (uint256)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        uint256 startGas = gasleft();</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        // We don&#x27;t provide an error message here, as we use it to return the estimate</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        // solium-disable-next-line error-reason</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        require(execute(to, value, data, operation, gasleft()));</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        uint256 requiredGas = startGas - gasleft();</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        // Convert response to string and return via error message</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        revert(string(abi.encodePacked(requiredGas)));</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    /**</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    * @dev Marks a hash as approved. This can be used to validate a hash that is used by a signature.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    * @param hashToApprove The hash that should be marked as approved for signatures that are verified by this contract.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    */</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    function approveHash(bytes32 hashToApprove)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    external</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        require(owners[msg.sender] != address(0), &quot;Only owners can approve a hash&quot;);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        approvedHashes[msg.sender][hashToApprove] = 1;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        emit ApproveHash(hashToApprove, msg.sender);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    /**</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    * @dev Marks a message as signed</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    * @param _data Arbitrary length data that should be marked as signed on the behalf of address(this)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    */</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    function signMessage(bytes calldata _data)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    external</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    authorized</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        bytes32 msgHash = getMessageHash(_data);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        signedMessages[msgHash] = 1;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        emit SignMsg(msgHash);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    /**</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    * Implementation of ISignatureValidator (see `interfaces/ISignatureValidator.sol`)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    * @dev Should return whether the signature provided is valid for the provided data.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    *       The save does not implement the interface since `checkSignatures` is not a view method.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    *       The method will not perform any state changes (see parameters of `checkSignatures`)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    * @param _data Arbitrary length data signed on the behalf of address(this)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    * @param _signature Signature byte array associated with _data</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    * @return a bool upon valid or invalid signature with corresponding _data</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    */</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    function isValidSignature(bytes calldata _data, bytes calldata _signature)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    external</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    returns (bytes4)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        bytes32 messageHash = getMessageHash(_data);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        if (_signature.length == 0) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            require(signedMessages[messageHash] != 0, &quot;Hash not approved&quot;);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        } else {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            // consumeHash needs to be false, as the state should not be changed</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            checkSignatures(messageHash, _data, _signature, false);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        return EIP1271_MAGIC_VALUE;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    /// @dev Returns hash of a message that can be signed by owners.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    /// @param message Message that should be hashed</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    /// @return Message hash.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    function getMessageHash(</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        bytes memory message</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    )</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    public</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    view</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    returns (bytes32)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        bytes32 safeMessageHash = keccak256(</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            abi.encode(SAFE_MSG_TYPEHASH, keccak256(message))</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        );</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        return keccak256(</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            abi.encodePacked(byte(0x19), byte(0x01), domainSeparator, safeMessageHash)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        );</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    /// @dev Returns the bytes that are hashed to be signed by owners.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    /// @param to Destination address.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    /// @param value Ether value.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    /// @param data Data payload.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    /// @param operation Operation type.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    /// @param safeTxGas Fas that should be used for the safe transaction.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    /// @param baseGas Gas costs for data used to trigger the safe transaction.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    /// @param gasPrice Maximum gas price that should be used for this transaction.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    /// @param gasToken Token address (or 0 if ETH) that is used for the payment.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    /// @param refundReceiver Address of receiver of gas payment (or 0 if tx.origin).</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    /// @param _nonce Transaction nonce.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    /// @return Transaction hash bytes.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    function encodeTransactionData(</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        address to,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        uint256 value,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        bytes memory data,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        Enum.Operation operation,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        uint256 safeTxGas,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        uint256 baseGas,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        uint256 gasPrice,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        address gasToken,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        address refundReceiver,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        uint256 _nonce</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    )</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    public</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    view</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    returns (bytes memory)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        bytes32 safeTxHash = keccak256(</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            abi.encode(SAFE_TX_TYPEHASH, to, value, keccak256(data), operation, safeTxGas, baseGas, gasPrice, gasToken, refundReceiver, _nonce)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        );</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        return abi.encodePacked(byte(0x19), byte(0x01), domainSeparator, safeTxHash);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    /// @dev Returns hash to be signed by owners.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    /// @param to Destination address.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    /// @param value Ether value.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    /// @param data Data payload.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    /// @param operation Operation type.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    /// @param safeTxGas Fas that should be used for the safe transaction.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    /// @param baseGas Gas costs for data used to trigger the safe transaction.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    /// @param gasPrice Maximum gas price that should be used for this transaction.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    /// @param gasToken Token address (or 0 if ETH) that is used for the payment.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    /// @param refundReceiver Address of receiver of gas payment (or 0 if tx.origin).</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    /// @param _nonce Transaction nonce.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    /// @return Transaction hash.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    function getTransactionHash(</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        address to,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        uint256 value,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        bytes memory data,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        Enum.Operation operation,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        uint256 safeTxGas,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        uint256 baseGas,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        uint256 gasPrice,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        address gasToken,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        address refundReceiver,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        uint256 _nonce</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    )</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    public</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    view</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    returns (bytes32)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        return keccak256(encodeTransactionData(to, value, data, operation, safeTxGas, baseGas, gasPrice, gasToken, refundReceiver, _nonce));</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div></div></div></div></div></div></article><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Blog list page navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/doc5"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label"> Uniswap-Pairs-Prices</div></a></div><div class="pagination-nav__item pagination-nav__item--next"></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_3SO_"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#orca-token" class="table-of-contents__link">Orca Token</a></li><li><a href="#governance-token" class="table-of-contents__link">Governance Token</a></li><li><a href="#governance-proxy" class="table-of-contents__link">Governance Proxy</a></li><li><a href="#governance-protocol" class="table-of-contents__link">Governance Protocol</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><h4 class="footer__title">Docs</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/docs/doc1">Orcadefi-SDK</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/doc3">Orca Governance Token</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Community</h4><ul class="footer__items"><li class="footer__item"><a href="mailto: dev@orcadefi.com" target="_blank" rel="noopener noreferrer" class="footer__link-item">Development Team</a></li><li class="footer__item"><a href="https://twitter.com/orcadefi" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">More</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/orcadefi" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub</a></li></ul></div></div><div class="text--center"><div>Copyright  2020 OrcaDeFI, Inc. Built with Docusaurus.</div></div></div></footer></div>
<script src="/styles.40491fba.js"></script>
<script src="/runtime~main.03d5b84e.js"></script>
<script src="/main.760b6be9.js"></script>
<script src="/1.6bcf3012.js"></script>
<script src="/2.ef7fac2f.js"></script>
<script src="/31.a2f0dcc7.js"></script>
<script src="/32.2d58906c.js"></script>
<script src="/f976f453.838baf88.js"></script>
<script src="/17896441.bc9cefac.js"></script>
<script src="/991b72a1.4bb81925.js"></script>
</body>
</html>